<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tatami_layered: tatami helpers for creating layered matrices</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">tatami_layered
   </div>
   <div id="projectbrief">Create layered sparse matrices for tatami</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">tatami helpers for creating layered matrices </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2github_2workspace_2README"></a></p>
<p><img src="https://github.com/tatami-inc/tatami_layered/actions/workflows/run-tests.yaml/badge.svg" alt="Unit tests" style="pointer-events: none;" class="inline"/> <img src="https://github.com/tatami-inc/tatami_layered/actions/workflows/doxygenate.yaml/badge.svg" alt="Documentation" style="pointer-events: none;" class="inline"/> <a href="https://codecov.io/gh/tatami-inc/tatami_layered"><img src="https://codecov.io/gh/tatami-inc/tatami_layered/graph/badge.svg?token=I5w28POARD" alt="codecov" style="pointer-events: none;" class="inline"/></a></p>
<h1>Overview</h1>
<p>Layered matrices are a space optimization of sparse matrices containing small positive counts, where we store rows in different "layers" depending on whether their maximum count is large enough to fit into an unsigned 8-bit, 16-bit or 32-bit integer. This reduces the memory usage compared to naively storing counts for all rows in the largest integer size across the entire matrix. It is intended to be used with gene expression data where different genes (rows) can vary widely in their expression.</p>
<h1>Quick start</h1>
<p>We can easily convert an existing <code><a class="elRef" href="https://tatami-inc.github.io/tatami/classtatami_1_1Matrix.html">tatami::Matrix</a></code> to a layered sparse matrix:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="tatami__layered_8hpp.html">tatami_layered/tatami_layered.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="structtatami__layered_1_1ConvertToLayeredSparseOptions.html">tatami_layered::ConvertToLayeredSparseOptions</a> copt;</div>
<div class="line"><span class="keyword">auto</span> converted = <a class="code hl_function" href="namespacetatami__layered.html#ae6f881696ce1e2fa7b9e2aeb3e38678b">tatami_layered::convert_to_layered_sparse</a>(*mat, copt);</div>
<div class="ttc" id="anamespacetatami__layered_html_ae6f881696ce1e2fa7b9e2aeb3e38678b"><div class="ttname"><a href="namespacetatami__layered.html#ae6f881696ce1e2fa7b9e2aeb3e38678b">tatami_layered::convert_to_layered_sparse</a></div><div class="ttdeci">std::shared_ptr&lt; tatami::Matrix&lt; ValueOut_, IndexOut_ &gt; &gt; convert_to_layered_sparse(const tatami::Matrix&lt; ValueIn_, IndexIn_ &gt; &amp;mat, const ConvertToLayeredSparseOptions &amp;options)</div><div class="ttdef"><b>Definition</b> convert_to_layered_sparse.hpp:404</div></div>
<div class="ttc" id="astructtatami__layered_1_1ConvertToLayeredSparseOptions_html"><div class="ttname"><a href="structtatami__layered_1_1ConvertToLayeredSparseOptions.html">tatami_layered::ConvertToLayeredSparseOptions</a></div><div class="ttdoc">Options for convert_to_layered_sparse().</div><div class="ttdef"><b>Definition</b> convert_to_layered_sparse.hpp:360</div></div>
<div class="ttc" id="atatami__layered_8hpp_html"><div class="ttname"><a href="tatami__layered_8hpp.html">tatami_layered.hpp</a></div><div class="ttdoc">Umbrella header for the tatami_layered library.</div></div>
</div><!-- fragment --><p>We can also read a layered sparse matrix from a Matrix Market file:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structtatami__layered_1_1ReadLayeredSparseFromMatrixMarketOptions.html">tatami_layered::ReadLayeredSparseFromMatrixMarketOptions</a> ropt;</div>
<div class="line"><span class="keyword">auto</span> loaded = <a class="code hl_function" href="namespacetatami__layered.html#a99e2feeee42e4ab42b8f7db3e0144419">tatami_layered::read_layered_sparse_from_matrix_market_text_file</a>(path.c_str(), ropt);</div>
<div class="ttc" id="anamespacetatami__layered_html_a99e2feeee42e4ab42b8f7db3e0144419"><div class="ttname"><a href="namespacetatami__layered.html#a99e2feeee42e4ab42b8f7db3e0144419">tatami_layered::read_layered_sparse_from_matrix_market_text_file</a></div><div class="ttdeci">std::shared_ptr&lt; tatami::Matrix&lt; Value_, Index_ &gt; &gt; read_layered_sparse_from_matrix_market_text_file(const char *filepath, const ReadLayeredSparseFromMatrixMarketOptions &amp;options)</div><div class="ttdef"><b>Definition</b> read_layered_sparse_from_matrix_market.hpp:222</div></div>
<div class="ttc" id="astructtatami__layered_1_1ReadLayeredSparseFromMatrixMarketOptions_html"><div class="ttname"><a href="structtatami__layered_1_1ReadLayeredSparseFromMatrixMarketOptions.html">tatami_layered::ReadLayeredSparseFromMatrixMarketOptions</a></div><div class="ttdef"><b>Definition</b> read_layered_sparse_from_matrix_market.hpp:190</div></div>
</div><!-- fragment --><p>Check out the <a href="https://tatami-inc.github.io/tatami_layered">documentation</a> for more details.</p>
<h1>Building projects</h1>
<h2>CMake with <code>FetchContent</code></h2>
<p>If you're using CMake, you just need to add something like this to your <code>CMakeLists.txt</code>:</p>
<div class="fragment"><div class="line">include(FetchContent)</div>
<div class="line"> </div>
<div class="line">FetchContent_Declare(</div>
<div class="line">  tatami_layered</div>
<div class="line">  GIT_REPOSITORY https://github.com/tatami-inc/tatami_layered</div>
<div class="line">  GIT_TAG master # or any version of interest </div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">FetchContent_MakeAvailable(tatami_layered)</div>
</div><!-- fragment --><p>Then you can link to <b><a class="el" href="namespacetatami__layered.html" title="Create layered sparse matrices for tatami.">tatami_layered</a></b> to make the headers available during compilation:</p>
<div class="fragment"><div class="line"># For executables:</div>
<div class="line">target_link_libraries(myexe tatami_layered)</div>
<div class="line"> </div>
<div class="line"># For libaries</div>
<div class="line">target_link_libraries(mylib INTERFACE tatami_layered)</div>
</div><!-- fragment --><h2>CMake using <code>find_package()</code></h2>
<p>You can install the library by cloning a suitable version of this repository and running the following commands:</p>
<div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div>
<div class="line">cmake .. -DTATAMI_LAYERED_TESTS=OFF</div>
<div class="line">cmake --build . --target install</div>
</div><!-- fragment --><p>Then you can use <code>find_package()</code> as usual:</p>
<div class="fragment"><div class="line">find_package(tatami_tatami_layered CONFIG REQUIRED)</div>
<div class="line">target_link_libraries(mylib INTERFACE tatami::tatami_layered)</div>
</div><!-- fragment --><h2>Manual</h2>
<p>If you're not using CMake, the simple approach is to just copy the files - either directly or with Git submodules - and include their path during compilation with, e.g., GCC's <code>-I</code>. This will also require the various dependencies listed in the <a href="extern/CMakeLists.txt"><code>extern/CMakeLists.txt</code></a> file. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
